-- Rayfield + Work.ink Key Validation + Multi-Script per GameID/PlaceID
local VALIDATE_BASE = "https://work.ink/_api/v2/token/isValid/"

-- Mapping GameID atau PlaceID ke script URL
local ScriptURLs = {
    [7892942274] = "https://pastebin.com/raw/", -- Crypto Farm (GameId)
    [7892942274] = "https://pastebin.com/raw/", -- Crypto Farm (GameId)
    [7892942274] = "https://pastebin.com/raw/", -- Crypto Farm (GameId)
    [7892942274] = "https://pastebin.com/raw/", -- Crypto Farm (GameId)
    [7892942274] = "https://pastebin.com/raw/", -- Crypto Farm (GameId)
}

-- detect request function
local request = (syn and syn.request) or (http and http.request) or http_request or request
if not request then
    error("Exploit tidak mendukung HTTP request (syn.request / http.request / http_request diperlukan).")
end

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "üëëDarkJokesüëë",
    LoadingTitle = "DarkJokes Hub",
    LoadingSubtitle = "Key System",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "DarkJokesHub",
        FileName = "KeyConfig"
    }
})
local Tab = Window:CreateTab("üè° Home")
local storedKey = nil
local StatusLabel = Tab:CreateLabel("Status: Waiting Key.....")

-- helper: panggil Work.ink API untuk cek token
local function checkWorkInkToken(token, deleteOnUse)
    if not token or token == "" then
        return false, "No token provided"
    end

    -- url encode token for safety
    local encoded = HttpService:UrlEncode(token)
    local url = VALIDATE_BASE .. encoded
    if deleteOnUse then
        url = url .. "?deleteToken=1"
    end

    local ok, resp = pcall(function()
        return request({
            Url = url,
            Method = "GET",
            -- Jika perlu header custom, tambahkan di bawah ini, contoh:
            -- Headers = { ["User-Agent"] = "DarkJokes/1.0" }
        })
    end)

    if not ok or not resp or (type(resp) ~= "table") then
        return false, "HTTP request failed"
    end

    -- resp.Body atau resp.body
    local body = resp.Body or resp.body or ""
    if body == "" then
        return false, "Empty response from API"
    end

    local successDecode, data = pcall(function() return HttpService:JSONDecode(body) end)
    if not successDecode then
        return false, "Invalid JSON from API"
    end

    -- Work.ink biasanya mengembalikan sesuatu seperti { valid = true/false, reason = "...", ... }
    if data.valid == true then
        return true, data
    else
        return false, data
    end
end

-- Cek koneksi singkat ke Work.ink (opsional)
local function checkAPIConnection()
    local ok, resp = pcall(function()
        return request({ Url = "https://work.ink/_api/v2/token/isValid/", Method = "GET" })
    end)
    if ok and resp and (resp.StatusCode == 200 or resp.StatusCode == 204) then
        StatusLabel:Set("Status: ‚úÖ Server Connected")
    else
        StatusLabel:Set("Status: ‚ö†Ô∏è Server Error (Please Contact Developer)")
    end
end
-- jalankan cek koneksi (boleh di-comment kalau tidak perlu)
pcall(checkAPIConnection)

-- Input Key
Tab:CreateInput({
    Name = "‚ö° Input Key",
    PlaceholderText = "Paste Key Here",
    RemoveTextAfterFocusLost = false,
    Callback = function(value)
        storedKey = value
    end,
})

-- Button Load Key
Tab:CreateButton({
    Name = "‚û°Ô∏è Load Key",
    Callback = function()
        if not storedKey or storedKey == "" then
            Rayfield:Notify({ Title = "Error", Content = "Please get key first.", Duration = 4 })
            return
        end

        StatusLabel:Set("Status: üîé Validating key...")
        local ok, result = checkWorkInkToken(storedKey)

        if not ok then
            -- result bisa string (error msg) atau table (data yang mengindikasikan invalid)
            local msg = (type(result) == "string") and result or tostring(result.reason or "Invalid key")
            StatusLabel:Set("Status: ‚ùå Invalid")
            Rayfield:Notify({ Title = "Invalid", Content = "Key tidak valid: " .. msg, Duration = 5 })
            return
        end

        -- valid
        StatusLabel:Set("Status: ‚úÖ Key valid")
        Rayfield:Notify({ Title = "Success", Content = "Key valid ‚Äî " .. tostring(result.reason or "ok"), Duration = 4 })

        -- cek script sesuai PlaceId atau GameId
        local scriptUrlForGame = ScriptURLs[game.PlaceId] or ScriptURLs[game.GameId]
        if scriptUrlForGame then
            local ok2, resp2 = pcall(function()
                return request({ Url = scriptUrlForGame, Method = "GET" })
            end)

            if not ok2 or not resp2 then
                Rayfield:Notify({ Title = "Error", Content = "Gagal mengambil script utama.", Duration = 5 })
                return
            end

            local scriptBody = resp2.Body or resp2.body or ""
            if scriptBody == "" then
                Rayfield:Notify({ Title = "Error", Content = "Script utama kosong atau tidak dapat diambil.", Duration = 5 })
                return
            end

            local ok3, err3 = pcall(function()
                local f = loadstring(scriptBody)
                if not f then error("loadstring returned nil") end
                f()
            end)

            if not ok3 then
                Rayfield:Notify({ Title = "Error", Content = "Gagal menjalankan script utama: " .. tostring(err3), Duration = 6 })
            end
        else
            Rayfield:Notify({ Title = "Game Mismatch", Content = "Tidak ada script untuk game ini.", Duration = 6 })
        end
    end
})

Tab:CreateSection("üïπÔ∏èMenu Game DarkJokes")
local Dropdown = Tab:CreateDropdown({
   Name = "Script List Game (Daftar Game)",
   Options = {"Plants Vs Brainrots","Combat Arena","Grow A Crypto Farm","Fish It","Kawasan Manado","Mount Perdaunan","Mount Pengangguran","Mount Kawaii","Mount Daun","Mount Yahayuk","Mount YNTKTS","Mount Aneh","Mount Kahayang","Mount Baraya"},
   CurrentOption = {"‚û°Ô∏è"},
   MultipleOptions = false,
   Flag = "Dropdown1", -- A flag is the identifier for the configuration file, make sure every element has a different flag if you're using configuration saving to ensure no overlaps
   Callback = function(Options)
   -- The function that takes place when the selected option is changed
   -- The variable (Options) is a table of strings for the current selected options
   end,
})

local KeyTab = Window:CreateTab("üóùÔ∏è GET KEY HERE")
-- üîë Link Key (contoh link, ganti sesuai kebutuhan)
local LINK = "https://workink.net/24WQ/4s9f9vbd"
KeyTab:CreateSection("Serial Key")
KeyTab:CreateButton({
    Name = "‚û°Ô∏è GET KEY",
    Callback = function()
        if setclipboard then
            setclipboard(LINK)
        elseif syn and syn.set_clipboard then
            syn.set_clipboard(LINK)
        elseif set_clipboard then
            set_clipboard(LINK)
        end
        Rayfield:Notify({ Title = "Link has copy", Content = "Paste in your browser", Duration = 5 })
    end
})

--[[local LINK = "https://workink.net/24WQ/ec1gqrbt"
KeyTab:CreateSection("Get Premium Key")
KeyTab:CreateButton({
    Name = "‚û°Ô∏è BUY KEY",
    Callback = function()
        if setclipboard then
            setclipboard(LINK)
        elseif syn and syn.set_clipboard then
            syn.set_clipboard(LINK)
        elseif set_clipboard then
            set_clipboard(LINK)
        end
        Rayfield:Notify({ Title = "Link has copy", Content = "Paste in your browser", Duration = 5 })
    end
})--]]

local DcTab = Window:CreateTab("üåê Community")

-- üåê Discord
local LINKDC = "https://discord.gg/5h2PDy3eJh"
DcTab:CreateSection(">")
DcTab:CreateButton({
    Name = "‚û°Ô∏è Join Discord",
    Callback = function()
        if setclipboard then
            setclipboard(LINKDC)
        elseif syn and syn.set_clipboard then
            syn.set_clipboard(LINKDC)
        elseif set_clipboard then
            set_clipboard(LINKDC)
        end
        Rayfield:Notify({ Title = "Link has copy", Content = "Paste in your browser", Duration = 5 })
    end
})

local InfoTab = Window:CreateTab("‚ÑπÔ∏è Information")
InfoTab:CreateSection("About Script")
InfoTab:CreateParagraph({
	Title = "üëë DarkJokes Script Hub",
	Content = [[
‚öôÔ∏è Hello Dontol:
- Script Version 2.1
- Last Update 15/10/2026
- Bypass added in Script
- Full compatibility with executors (Mobile + PC)
]]
})



